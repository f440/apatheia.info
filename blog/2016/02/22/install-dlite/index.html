<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>DLiteでOS X上にDockerの環境を構築する - aptheia.info</title><link rel="alternate" type="application/rss+xml" title="apatheia.info" href="/atom.xml"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/490828b4c4131e135f17.css" as="style"/><link rel="stylesheet" href="/_next/static/css/490828b4c4131e135f17.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-1a8a258926ecde76681b.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-a9acf05574b3448968f1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c8f1e010c17d4a8ac8e7.js" defer=""></script><script src="/_next/static/chunks/915-c287d7adb8a31cf4da35.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-c134caf83809c687960e.js" defer=""></script><script src="/_next/static/jhtzWSA_9WoQI8qF29M1i/_buildManifest.js" defer=""></script><script src="/_next/static/jhtzWSA_9WoQI8qF29M1i/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header><div id="site-title"><h1><a href="/">apatheia.info</a></h1></div><nav><ul><li><a href="/">Home</a></li><li><a href="/atom.xml">RSS</a></li></ul></nav></header><main><article><h1>DLiteでOS X上にDockerの環境を構築する</h1><p id="article-info">Published on <!-- -->2016.02.22<!-- --> <span><a href="/blog/categories/docker/">docker</a> </span></p><div><p><a href="https://github.com/nlf/dlite">DLite</a> をインストールしたので、そのときのメモ。</p>
<!-- more -->
<h2>DLiteとは</h2>
<p>OS XでDockerを使えるようにやつ。内部では<a href="https://github.com/mist64/xhyve">xhyve</a>を使っていて非常にコンパクト。</p>
<h2>作業環境</h2>
<ul>
<li>DLite 1.1.3</li>
<li>OS X El capitan 10.11.3</li>
</ul>
<h2>インストール手順</h2>
<pre><code>brew install dlite
sudo dlite install # CPUやディスクサイズなどのオプションは`-h`で確認可能
</code></pre>
<p>おしまい。</p>
<p>内部では以下が行われる:</p>
<ul>
<li><code>/etc/sudoers</code>に<code>dlite,nfs</code>コマンドをパスワードなしで<code>sudo</code>できるようにする設定を追加</li>
<li><code>~/Library/LaunchAgents/local.dlite.plist</code>に起動設定を配置</li>
<li><code>~/.dlite</code>に起動イメージをダウンロード</li>
</ul>
<h2>起動</h2>
<p>Tmux内で起動しようとするとエラーになるので、必ずTmux外でやること。</p>
<pre><code>dlite start
</code></pre>
<p>問題がなければ以下が加えられる:</p>
<ul>
<li><code>/var/run/docker.sock</code> にソケットファイルを作成</li>
<li><code>/etc/hosts</code> にdliteへの参照を追加 (デフォルトは <code>local.docker</code>。インストール時のオプションで変更可能)</li>
<li><code>/etc/exports</code> にDLite側のホストへのNFSマウントする設定を追加</li>
<li><code>~/Library/LaunchAgents/local.dlite.plist</code> をロードし、自動起動するように設定</li>
</ul>
<p>うまくいっていれば、<code>docker -H unix://var/run/docker.sock</code>(<code>export DOCKER_HOST=unix:///var/run/docker.sock</code>で指定も可)でdockerが使えるようになる。</p>
<p>もしうまくいかないようなら、<code>sudo dlite daemon</code>でコマンドラインから実行して原因を突き止める。とくに、NFS周りのコンフリクトが起きていないかを確認。</p>
<h2>まとめ</h2>
<p>ホストと仮想環境の間がシームレスにつながってcoLinuxっぽさがある。こういうすっきりしたツールは楽しい。</p>
<h2>追記</h2>
<p>2016-05-08: 現在はDocker for Macを利用している。osxfsでファイルシステムのイベントが連携できて便利。</p>
<h2>参考</h2>
<ul>
<li><a href="https://github.com/nlf/dlite">GitHub - nlf/dlite: The simplest way to use Docker on OS X</a></li>
<li><a href="https://blog.andyet.com/2016/01/25/easy-docker-on-osx/">Simplifying Docker on OS X</a></li>
</ul>
</div></article></main><footer><ul><li>Link:</li><li><a href="https://twitter.com/f440">Twitter</a></li><li><a href="https://github.com/f440">Github</a></li><li><a href="https://pinbaord.in/u:f440">Pinbaord</a></li></ul></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"localPath":"/home/f440/go/src/github.com/f440/f440.github.com/content/2016-02-22-install-dlite.markdown","path":"2016/02/22/install-dlite","layout":"post","title":"DLiteでOS X上にDockerの環境を構築する","createdAt":"2016-02-22T11:54:00.000Z","updatedAt":"2016-05-08T10:12:00.000Z","kind":"article","comments":true,"tags":["docker"],"content":"\u003cp\u003e\u003ca href=\"https://github.com/nlf/dlite\"\u003eDLite\u003c/a\u003e をインストールしたので、そのときのメモ。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2\u003eDLiteとは\u003c/h2\u003e\n\u003cp\u003eOS XでDockerを使えるようにやつ。内部では\u003ca href=\"https://github.com/mist64/xhyve\"\u003exhyve\u003c/a\u003eを使っていて非常にコンパクト。\u003c/p\u003e\n\u003ch2\u003e作業環境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eDLite 1.1.3\u003c/li\u003e\n\u003cli\u003eOS X El capitan 10.11.3\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eインストール手順\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003ebrew install dlite\nsudo dlite install # CPUやディスクサイズなどのオプションは`-h`で確認可能\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eおしまい。\u003c/p\u003e\n\u003cp\u003e内部では以下が行われる:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/etc/sudoers\u003c/code\u003eに\u003ccode\u003edlite,nfs\u003c/code\u003eコマンドをパスワードなしで\u003ccode\u003esudo\u003c/code\u003eできるようにする設定を追加\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e~/Library/LaunchAgents/local.dlite.plist\u003c/code\u003eに起動設定を配置\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e~/.dlite\u003c/code\u003eに起動イメージをダウンロード\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e起動\u003c/h2\u003e\n\u003cp\u003eTmux内で起動しようとするとエラーになるので、必ずTmux外でやること。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edlite start\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e問題がなければ以下が加えられる:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/var/run/docker.sock\u003c/code\u003e にソケットファイルを作成\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/etc/hosts\u003c/code\u003e にdliteへの参照を追加 (デフォルトは \u003ccode\u003elocal.docker\u003c/code\u003e。インストール時のオプションで変更可能)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/etc/exports\u003c/code\u003e にDLite側のホストへのNFSマウントする設定を追加\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e~/Library/LaunchAgents/local.dlite.plist\u003c/code\u003e をロードし、自動起動するように設定\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eうまくいっていれば、\u003ccode\u003edocker -H unix://var/run/docker.sock\u003c/code\u003e(\u003ccode\u003eexport DOCKER_HOST=unix:///var/run/docker.sock\u003c/code\u003eで指定も可)でdockerが使えるようになる。\u003c/p\u003e\n\u003cp\u003eもしうまくいかないようなら、\u003ccode\u003esudo dlite daemon\u003c/code\u003eでコマンドラインから実行して原因を突き止める。とくに、NFS周りのコンフリクトが起きていないかを確認。\u003c/p\u003e\n\u003ch2\u003eまとめ\u003c/h2\u003e\n\u003cp\u003eホストと仮想環境の間がシームレスにつながってcoLinuxっぽさがある。こういうすっきりしたツールは楽しい。\u003c/p\u003e\n\u003ch2\u003e追記\u003c/h2\u003e\n\u003cp\u003e2016-05-08: 現在はDocker for Macを利用している。osxfsでファイルシステムのイベントが連携できて便利。\u003c/p\u003e\n\u003ch2\u003e参考\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nlf/dlite\"\u003eGitHub - nlf/dlite: The simplest way to use Docker on OS X\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.andyet.com/2016/01/25/easy-docker-on-osx/\"\u003eSimplifying Docker on OS X\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["2016","02","22","install-dlite"]},"buildId":"jhtzWSA_9WoQI8qF29M1i","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>